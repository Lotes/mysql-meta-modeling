package de.loteslab.mmm.sqlc.lang;

import java.util.HashSet;

import org.antlr.v4.runtime.ParserRuleContext;

import de.loteslab.mmm.sqlc.lang.MySqlParser.ColumnCreateTableContext;
import de.loteslab.mmm.sqlc.lang.MySqlParser.CopyCreateTableContext;
import de.loteslab.mmm.sqlc.lang.MySqlParser.QueryCreateTableContext;

public class NameTreeVisitor extends MySqlParserBaseVisitor<Integer> {
	private HashSet<MySqlObject> imports = new HashSet<MySqlObject>();
	private HashSet<MySqlObject> exports = new HashSet<MySqlObject>();
	
	@Override
	public Integer visitCopyCreateTable(CopyCreateTableContext ctx) {
		export(MySqlObjectType.TABLE, ctx.name);
		return 0;
	}

	@Override
	public Integer visitQueryCreateTable(QueryCreateTableContext ctx) {
		export(MySqlObjectType.TABLE, ctx.name);
		return 0;
	}
	
	@Override
	public Integer visitColumnCreateTable(ColumnCreateTableContext ctx) {
		export(MySqlObjectType.TABLE, ctx.name);
		return 0;
	}
	
	private void export(MySqlObjectType type, ParserRuleContext ctx) {
		exports.add(MySqlObject.create(type, ctx.getText()));
	}
	
	public Iterable<MySqlObject> getImports() {
		return imports;
	}

	public Iterable<MySqlObject> getExports() {
		return exports;
	}
}
